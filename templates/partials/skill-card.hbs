<div class="skill-card item" data-item-id="{{_id}}">
  <img class="skill-icon" src="{{img}}" alt="{{name}}" draggable="true">
  {{#if system.isPerk}}
    {{#if (hasAnyRollFormula system)}}
      <div class="roll-dice" title="Бросить кубик">
        <i class="fas fa-dice-d20"></i>
      </div>
    {{/if}}
  {{else}}
    <div class="roll-dice" title="Бросить кубик">
      <i class="fas fa-dice-d20"></i>
    </div>
  {{/if}}

  <div class="skill-tooltip">
    <p><strong>{{name}}</strong></p>

    {{#if system.displayFields.Circle}}<p><strong>Круг:</strong> {{system.Circle}}</p>{{/if}}
    {{#if system.displayFields.Level}}<p><strong>Уровень:</strong> {{system.Level}}</p>{{/if}}
    {{#if system.displayFields.isRacial}}<p><strong>Расовая:</strong> {{#if system.isRacial}}да{{else}}нет{{/if}}</p>{{/if}}

    {{#if system.displayFields.Range}}<p><strong>Дальность:</strong> {{system.Range}}</p>{{/if}}
    {{#if system.displayFields.AttackArea}}<p><strong>Зона:</strong> {{system.AttackArea}}</p>{{/if}}
    {{#if system.displayFields.Duration}}<p><strong>Длительность:</strong> {{system.Duration}}</p>{{/if}}

    {{#if system.displayFields.Description}}<p><strong>Описание:</strong> {{system.Description}}</p>{{/if}}
    {{#if system.displayFields.Effects}}<p><strong>Эффекты:</strong> {{{formatEffects system.Effects}}}</p>{{/if}}

    {{#if system.displayFields.Damage}}<p><strong>{{#if (isSelected system.DamageMode "heal")}}Лечение{{else}}Урон{{/if}}:</strong> {{system.Damage}}</p>{{/if}}
    {{#if system.displayFields.Multiplier}}<p><strong>Множитель:</strong> {{system.Multiplier}}</p>{{/if}}
    {{#if system.displayFields.UsageCost}}<p><strong>Стоимость:</strong> {{system.UsageCost}}</p>{{/if}}
    {{#if system.displayFields.Cooldown}}<p><strong>Перезарядка:</strong> {{system.Cooldown}}</p>{{/if}}

    {{#if system.displayFields.DeliveryType}}<p><strong>Тип применения:</strong> {{deliveryTypeLabel system.DeliveryType "Skill"}}</p>{{/if}}
    {{#if system.displayFields.SaveAbility}}<p><strong>Проверка цели:</strong> {{localize system.SaveAbility}}</p>{{/if}}
    {{#if system.displayFields.SaveDCFormula}}<p><strong>Формула сложности:</strong> {{system.SaveDCFormula}}</p>{{/if}}
        {{#if system.displayFields.RollFormulas}}
    {{#if system.RollFormulas.length}}
      <p><strong>Формулы броска:</strong> {{#each system.RollFormulas}}{{this}}{{#unless @last}}; {{/unless}}{{/each}}</p>
    {{/if}}
{{else}}
    {{#if system.displayFields.RollFormula}}
      {{#if system.RollFormula}}
        <p><strong>Формула броска:</strong> {{system.RollFormula}}</p>
      {{/if}}
    {{/if}}
{{/if}}

    {{#if system.displayFields.AreaShape}}<p><strong>Форма области:</strong> {{localize system.AreaShape}}</p>{{/if}}
    {{#if system.displayFields.AreaSize}}<p><strong>Размер области:</strong> {{system.AreaSize}}</p>{{/if}}
    {{#if system.displayFields.AreaWidth}}<p><strong>Ширина области:</strong> {{system.AreaWidth}}</p>{{/if}}
    {{#if system.displayFields.AreaAngle}}<p><strong>Угол области:</strong> {{system.AreaAngle}}</p>{{/if}}
    {{#if system.displayFields.AreaPersistent}}<p><strong>Постоянная область:</strong> {{#if system.AreaPersistent}}да{{else}}нет{{/if}}</p>{{/if}}
    {{#if system.displayFields.AreaColor}}<p><strong>Цвет области:</strong> {{#if system.AreaColor}}{{system.AreaColor}}{{else}}(цвет игрока){{/if}}</p>{{/if}}

    {{#if _cooldownView.inCombat}}
      {{#if _cooldownView.active}}
        <p style="color:#c00;"><strong>КД:</strong> доступен с раунда {{_cooldownView.availableFromRound}} (осталось {{_cooldownView.remainingRounds}})</p>
      {{/if}}
    {{/if}}

    {{#each system.additionalFields}}
      {{#if this.show}}
        {{#unless this.hidden}}
          <p><strong>{{this.name}}:</strong> {{this.value}}</p>
        {{/unless}}
      {{/if}}
    {{/each}}
  </div>
  {{#if @root.osCanEdit}}
  <button class="delete-skill" title="Удалить скилл" type="button">
    <i class="fas fa-times"></i>
  </button>
  {{/if}}
</div>
