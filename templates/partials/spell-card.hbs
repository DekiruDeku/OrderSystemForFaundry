<div class="spell-card item" data-item-id="{{_id}}">
  <img class="spell-icon" src="{{img}}" alt="{{name}}" draggable="true">
  <div class="roll-dice" title="Бросить кубик">
    <i class="fas fa-dice-d20"></i>
  </div>

  <div class="spell-tooltip">
    <p><strong>{{name}}</strong></p>

    {{#if system.displayFields.Circle}}<p><strong>Круг:</strong> {{system.Circle}}</p>{{/if}}
    {{#if system.displayFields.Level}}<p><strong>Уровень:</strong> {{system.Level}}</p>{{/if}}
    {{#if system.displayFields.Range}}<p><strong>Дистанция:</strong> {{system.Range}}</p>{{/if}}
    {{#if system.displayFields.Duration}}<p><strong>Длительность:</strong> {{system.Duration}}</p>{{/if}}

    {{#if system.displayFields.SpellType}}<p><strong>Тип заклинания:</strong> {{localize system.SpellType}}</p>{{/if}}
    {{#if system.displayFields.TriggerType}}<p><strong>Триггер:</strong> {{system.TriggerType}}</p>{{/if}}
    {{#if system.displayFields.EnemyInteractionType}}<p><strong>Взаимодействие с целью:</strong> {{localize system.EnemyInteractionType}}</p>{{/if}}

    {{#if system.displayFields.DamageType}}<p><strong>Тип урона:</strong> {{localize system.DamageType}}</p>{{/if}}
    {{#if system.displayFields.DamageSubtype}}<p><strong>Подтип урона:</strong> {{system.DamageSubtype}}</p>{{/if}}

    {{#if system.displayFields.Description}}<p><strong>Описание:</strong> {{system.Description}}</p>{{/if}}
    {{#if system.displayFields.EffectConditions}}<p><strong>Условие срабатывания эффекта:</strong> {{system.EffectConditions}}</p>{{/if}}
    {{#if system.displayFields.UsageConditions}}<p><strong>Условия применения:</strong> {{system.UsageConditions}}</p>{{/if}}

    {{#if system.displayFields.Effects}}<p><strong>Эффекты:</strong> {{{formatEffects system.Effects}}}</p>{{/if}}

    {{#if system.displayFields.Damage}}<p><strong>{{#if (isSelected system.DamageMode "heal")}}Лечение{{else}}Урон{{/if}}:</strong> {{system.Damage}}</p>{{/if}}
    {{#if system.displayFields.Multiplier}}<p><strong>Множитель:</strong> {{system.Multiplier}}</p>{{/if}}

    {{#if system.displayFields.UsageCost}}<p><strong>Стоимость:</strong> {{system.UsageCost}}</p>{{/if}}
    {{#if system.displayFields.ActionCost}}<p><strong>Стоимость действий:</strong> {{system.ActionCost}}</p>{{/if}}
    {{#if system.displayFields.UsageThreshold}}<p><strong>Порог условия:</strong> {{system.UsageThreshold}}</p>{{/if}}

    {{#if system.displayFields.DeliveryType}}<p><strong>Тип применения:</strong> {{deliveryTypeLabel system.DeliveryType "Spell"}}</p>{{/if}}
    {{#if system.displayFields.SaveAbility}}<p><strong>Проверка цели:</strong> {{formatSaveAbilities system}}</p>{{/if}}
    {{#if system.displayFields.SaveDCFormula}}<p><strong>Формула сложности:</strong> {{system.SaveDCFormula}}</p>{{/if}}
        {{#if system.displayFields.RollFormulas}}
    {{#if system.RollFormulas.length}}
      <p><strong>Формулы броска:</strong> {{#each system.RollFormulas}}{{this}}{{#unless @last}}; {{/unless}}{{/each}}</p>
    {{/if}}
{{else}}
    {{#if system.displayFields.RollFormula}}
      {{#if system.RollFormula}}
        <p><strong>Формула броска:</strong> {{system.RollFormula}}</p>
      {{/if}}
    {{/if}}
{{/if}}

    {{#if system.displayFields.AreaShape}}<p><strong>Форма области:</strong> {{localize system.AreaShape}}</p>{{/if}}
    {{#if system.displayFields.AreaSize}}<p><strong>Размер области:</strong> {{system.AreaSize}}</p>{{/if}}
    {{#if system.displayFields.AreaWidth}}<p><strong>Ширина области:</strong> {{system.AreaWidth}}</p>{{/if}}
    {{#if system.displayFields.AreaAngle}}<p><strong>Угол области:</strong> {{system.AreaAngle}}</p>{{/if}}
    {{#if system.displayFields.AreaPersistent}}<p><strong>Постоянная область:</strong> {{#if system.AreaPersistent}}да{{else}}нет{{/if}}</p>{{/if}}
    {{#if system.displayFields.AreaColor}}<p><strong>Цвет области:</strong> {{#if system.AreaColor}}{{system.AreaColor}}{{else}}(цвет игрока){{/if}}</p>{{/if}}

    {{#if system.displayFields.SummonActorUuid}}<p><strong>Сущность призыва:</strong> {{system.SummonActorUuid}}</p>{{/if}}
    {{#if system.displayFields.SummonCount}}<p><strong>Количество призыва:</strong> {{system.SummonCount}}</p>{{/if}}
    {{#if system.displayFields.SummonDisposition}}<p><strong>Отношение призыва:</strong> {{localize system.SummonDisposition}}</p>{{/if}}
    {{#if system.displayFields.SummonDeleteOnExpiry}}<p><strong>Удалять по окончании:</strong> {{#if system.SummonDeleteOnExpiry}}да{{else}}нет{{/if}}</p>{{/if}}

    {{#each system.additionalFields}}
      {{#if this.show}}
        {{#unless this.hidden}}
          <p><strong>{{this.name}}:</strong> {{this.value}}</p>
        {{/unless}}
      {{/if}}
    {{/each}}
  </div>
  {{#if @root.osCanEdit}}
  <button class="delete-spell" title="Удалить заклинание" type="button">
    <i class="fas fa-times"></i>
  </button>
  {{/if}}
</div>
